<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Heteroscedasticity and Autocorrelation Consistent (HAC) Covariance Matrix Estimation — vcovHAC • sandwich</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Heteroscedasticity and Autocorrelation Consistent (HAC) Covariance Matrix Estimation — vcovHAC" />
<meta property="og:description" content="Heteroscedasticity and autocorrelation consistent (HAC) estimation
 of the covariance matrix of the coefficient estimates in a (generalized)
 linear regression model." />
<meta property="og:image" content="https://sandwich.R-Forge.R-project.org/logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@AchimZeileis" />
<meta name="twitter:site" content="@AchimZeileis" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sandwich</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/sandwich.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jss_2004.html">Econometric Computing with HC and HAC Covariance Matrix Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2006.html">Object-Oriented Computation of Sandwich Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2020.html">Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Heteroscedasticity and Autocorrelation Consistent (HAC) Covariance Matrix Estimation</h1>
    
    <div class="hidden name"><code>vcovHAC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Heteroscedasticity and autocorrelation consistent (HAC) estimation
 of the covariance matrix of the coefficient estimates in a (generalized)
 linear regression model.</p>
    </div>

    <pre class="usage"><span class='fu'>vcovHAC</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>vcovHAC</span><span class='op'>(</span><span class='va'>x</span>, order.by <span class='op'>=</span> <span class='cn'>NULL</span>, prewhite <span class='op'>=</span> <span class='cn'>FALSE</span>, weights <span class='op'>=</span> <span class='va'>weightsAndrews</span>,
  adjust <span class='op'>=</span> <span class='cn'>TRUE</span>, diagnostics <span class='op'>=</span> <span class='cn'>FALSE</span>, sandwich <span class='op'>=</span> <span class='cn'>TRUE</span>, ar.method <span class='op'>=</span> <span class='st'>"ols"</span>,
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>meatHAC</span><span class='op'>(</span><span class='va'>x</span>, order.by <span class='op'>=</span> <span class='cn'>NULL</span>, prewhite <span class='op'>=</span> <span class='cn'>FALSE</span>, weights <span class='op'>=</span> <span class='va'>weightsAndrews</span>,
  adjust <span class='op'>=</span> <span class='cn'>TRUE</span>, diagnostics <span class='op'>=</span> <span class='cn'>FALSE</span>, ar.method <span class='op'>=</span> <span class='st'>"ols"</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a fitted model object.</p></td>
    </tr>
    <tr>
      <th>order.by</th>
      <td><p>Either a vector <code>z</code> or a formula with a single explanatory
    variable like <code>~ z</code>. The observations in the model
    are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
    default) the observations are assumed to be ordered (e.g., a
    time series).</p></td>
    </tr>
    <tr>
      <th>prewhite</th>
      <td><p>logical or integer. Should the estimating functions
    be prewhitened? If <code>TRUE</code> or greater than 0 a VAR model of
    order <code><a href='https://rdrr.io/r/base/integer.html'>as.integer(prewhite)</a></code> is fitted via <code>ar</code> with
    method <code>"ols"</code> and <code>demean = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Either a vector of weights for the autocovariances or a
    function to compute these weights based on <code>x</code>, <code>order.by</code>,
    <code>prewhite</code>, <code>ar.method</code> and <code>data</code>. If <code>weights</code>
    is a function it has to take these arguments. See also details.</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>logical. Should a finite sample adjustment be made?
    This amounts to multiplication with \(n/(n-k)\) where \(n\) is the
    number of observations and \(k\) the number of estimated parameters.</p></td>
    </tr>
    <tr>
      <th>diagnostics</th>
      <td><p>logical. Should additional model diagnostics be returned?
    See below for details.</p></td>
    </tr>
    <tr>
      <th>sandwich</th>
      <td><p>logical. Should the sandwich estimator be computed?
    If set to <code>FALSE</code> only the meat matrix is returned.</p></td>
    </tr>
    <tr>
      <th>ar.method</th>
      <td><p>character. The <code>method</code> argument passed to
   <code><a href='https://rdrr.io/r/stats/ar.html'>ar</a></code> for prewhitening.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the <code>order.by</code> 
    model. By default the variables are taken from the environment which
    <code>vcovHAC</code> is called from.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to <code><a href='sandwich.html'>sandwich</a></code> (in <code>vcovHAC</code>)
   and <code><a href='estfun.html'>estfun</a></code> (in <code>meatHAC</code>), respectively.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>meatHAC</code> is the real work horse for estimating
the meat of HAC sandwich estimators -- the default <code>vcovHAC</code> method
is a wrapper calling
<code><a href='sandwich.html'>sandwich</a></code> and <code><a href='bread.html'>bread</a></code>. See Zeileis (2006) for
more implementation details. The theoretical background, exemplified
for the linear regression model, is described in Zeileis (2004).</p>
<p>Both functions construct weighted information sandwich variance estimators
for parametric models fitted to time series data. These are basically
constructed from weighted sums of autocovariances of the estimating functions
(as extracted by <code><a href='estfun.html'>estfun</a></code>). The crucial step is the specification
of weights: the user can either supply <code>vcovHAC</code> with some vector of 
weights or with a function that computes these weights adaptively (based on
the arguments <code>x</code>, <code>order.by</code>, <code>prewhite</code> and <code>data</code>). 
Two functions for adaptively choosing weights are implemented in
<code><a href='weightsAndrews.html'>weightsAndrews</a></code> implementing the results of Andrews (1991) and
in <code><a href='weightsLumley.html'>weightsLumley</a></code> implementing the results of Lumley (1999).
The functions <code><a href='weightsAndrews.html'>kernHAC</a></code> and <code><a href='weightsLumley.html'>weave</a></code> respectively
are to more convenient interfaces for <code>vcovHAC</code> with these functions.</p>
<p>Prewhitening based on VAR approximations is described as suggested in
Andrews &amp; Monahan (1992).</p>
<p>The covariance matrix estimators have been improved by the addition of a bias correction and an
approximate denominator degrees of freedom for test and confidence interval
construction. See Lumley &amp; Heagerty (1999) for details.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix containing the covariance matrix estimate. If <code>diagnostics</code>
was set to <code>TRUE</code> this has an attribute <code>"diagnostics"</code> which is a list 
with</p>
<dt>bias.correction</dt><dd><p>multiplicative bias correction</p></dd>
  <dt>df</dt><dd><p>Approximate denominator degrees of freedom</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Andrews DWK (1991).
  &#8220;Heteroskedasticity and Autocorrelation Consistent Covariance Matrix Estimation.&#8221;
  <em>Econometrica</em>, <b>59</b>, 817--858.</p>
<p>Andrews DWK &amp; Monahan JC (1992).
  &#8220;An Improved Heteroskedasticity and Autocorrelation Consistent Covariance Matrix Estimator.&#8221;
  <em>Econometrica</em>, <b>60</b>, 953--966.</p>
<p>Lumley T &amp; Heagerty P (1999).
  &#8220;Weighted Empirical Adaptive Variance Estimators for Correlated Data Regression.&#8221;
  <em>Journal of the Royal Statistical Society B</em>, <b>61</b>, 459--477.</p>
<p>Newey WK &amp; West KD (1987).
  &#8220;A Simple, Positive Semi-Definite, Heteroskedasticity and Autocorrelation Consistent Covariance Matrix.&#8221;
  <em>Econometrica</em>, <b>55</b>, 703--708.</p>
<p>Zeileis A (2004).
  &#8220;Econometric Computing with HC and HAC Covariance Matrix Estimators.&#8221;
  <em>Journal of Statistical Software</em>, <b>11</b>(10), 1--17.
  doi: <a href='https://doi.org/10.18637/jss.v011.i10'>10.18637/jss.v011.i10</a></p>
<p>Zeileis A (2006).
  &#8220;Object-Oriented Computation of Sandwich Estimators.&#8221;
  <em>Journal of Statistical Software</em>, <b>16</b>(9), 1--16.
  doi: <a href='https://doi.org/10.18637/jss.v016.i09'>10.18637/jss.v016.i09</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='weightsLumley.html'>weightsLumley</a></code>, <code><a href='weightsAndrews.html'>weightsAndrews</a></code>,
         <code><a href='weightsLumley.html'>weave</a></code>, <code><a href='weightsAndrews.html'>kernHAC</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>
<span class='fu'>vcovHAC</span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             (Intercept)           x
#&gt; (Intercept) 0.009716252 0.004740023
#&gt; x           0.004740023 0.023346936</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              (Intercept)            x
#&gt; (Intercept) 1.114254e-02 2.818886e-05
#&gt; x           2.818886e-05 2.216611e-02</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Achim Zeileis, Thomas Lumley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


